<!DOCTYPE html>
<html lang = "en">
  <head>
    <meta charset="utf-8">
    <title>Hex Clock</title>
    <link rel = "stylesheet" href = "css/styles.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  </head>
  <body>
    <div class="vertical-flex">
      <section id = "youtube-body">
        <div id="player"></div>
        <div id="yt-control-flex">
          <input id = "youtube-input" type = "text"/>
          <button id = "yt-submit" class="btn">Submit</button>
          <button id = "yt-options" class="btn">...</button>
        </div>
        <!-- TODO Add in a button to search playlists?/display your existing playlist -->
        <div id="yt-search-results">

        </div>

        <script>
        //TODO - put this into a seperate file for simplicity sake

          const windowWidth = window.innerWidth;
          const playerHeight = windowWidth * 0.61;
          const starterVideo = (Math.floor(Math.random() * 214)).toString();


          var tag = document.createElement('script');

          tag.src = "https://www.youtube.com/iframe_api";
          var firstScriptTag = document.getElementsByTagName('script')[0];
          firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

          var player;
          function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
              height: playerHeight,
              width: windowWidth,
              //videoId: "hHW1oY26kxQ",
              playerVars: {
                color: "white",
                listType: "playlist",
                list: "PL0KqfOQxyR-MLbyTZLFUQuOfr9V5ElNSc",
                index: starterVideo,//Work on getting the list to shuffle each time for random videos
              },
              events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange,
                'onError': onPlayerError,
              }
            });
          }
          function onPlayerReady(event) {
            event.target.playVideo();
          }
          var done = false;

          function onPlayerStateChange(event) {
            if(event.data === 3){
              event.target.setShuffle({'shufflePlayList' : true});
            }
          }
          function onPlayerError(event){
            console.log("error event:", event);
          }

          //Handling Video changes
          // let submitButton = document.getElementById("submit-button");
          // submitButton.addEventListener("click", () => {
          //   let input = document.getElementById("youtube-input");
          //   let inputValue = input.value;
          //
          //   player.loadPlaylist({
          //     list: inputValue,
          //     listType: "search",
          //   });
          // });
        </script>
        <!-- CUT/PASTE FEST -->
        <script src="https://apis.google.com/js/api.js"></script>
        <script src="./js/youtubePlayer.js"></script>
        <!-- END CUT/PASTE FEST -->
      </section>

      <section id = "clock-body">
        <div id = "clock-wrapper">
          <h1 id = "clock"></h1>
          <h2 id = "date"></h2>
        </div>
      </section>
    </div>
  </body>
  <script>
    require('./js/hexClock.js');
  </script>

</html>
